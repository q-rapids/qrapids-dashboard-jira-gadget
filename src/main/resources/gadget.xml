<?xml version="1.0" encoding="UTF-8" ?>
<Module>

    <!-- Especifiaciones del Gadget (nombre, autor, ) -->
    <!-- screenshot: direccion de la imagen que un container o directory pueden usar para ilustrar el gadget -->
    <!-- thumbnail: direccion de la imagen en miniatura (120x60 px) que un container o directory pueden usar para ilustrar el gadget-->

    <ModulePrefs title="__MSG_gadget.title__"
                 directory_title="__MSG_gadget.title__"
                 description="__MSG_gadget.description__"
                 author="Surname Name"
                 author_email="author@email.com"
                 screenshot="__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/images/qrapids_logo.png"
                 thumbnail="__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/images/qrapids_logo.png">

        <!-- El elemento indica al container que el gadget puede utilizar una función específica -->
        <Optional feature="gadget-directory">
            <!-- Permite suministrar parametros para las funciones solicitadas a traves de los elementos -->
            <Param name="categories">
                JIRA
                Charts
                QRapids
            </Param>
        </Optional>
        <Optional feature="atlassian.util" />
        <Optional feature="auth-refresh" />

        <!-- El elemento indica al container que el gadget necesita un caracteristica especifica (librerias) -->
        <Require feature="views" />
        <Require feature="settitle"/>
        <Require feature="oauthpopup" />
        <Require feature="opensocial-0.8" />
        <Require feature="dynamic-height"/>
        <Require feature="minimessage"/>
        <Require feature="setprefs" />

        #oauth
        <Locale messages="__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/i18n/ALL_ALL.xml"/>
    </ModulePrefs>

    <!--
    Esta sección le permite a los usuarios una forma de proporcionar sus preferencias "preferencias del usuario".
    Estos campos de entrada del usuario se convierten en controles de interfaz de usuario cuando se ejecuta el gadget.
    Cuando se muestra el gadget en iGoogle, se puede acceder a las preferencias del usuario desde el menú desplegable "Editar".

    El contenedor maneja la generación de la IU de configuración, guarda la configuración y proporciona una API para acceder a la configuración en JavaScript.
    -->
    <UserPref name="show_date" display_name="Show Dates?" datatype="bool" default_value="true"/>
    <UserPref name="show_summ" display_name="Show Summaries?" datatype="bool" default_value="true"/>
    <UserPref name="num_entries" display_name="Number of Entries:" default_value="5"/>
    <UserPref name="selectedTab" datatype="hidden"/>


    <!--
    En esta sección, definirá el tipo de contenido, e incluirá el contenido en sí mismo o proporcionará una URL para extraer el contenido de una fuente externa.
    Combinará los atributos y las preferencias del usuario y la información.

    Hay dos tipos principales de contenido de gadget, que se distinguen por el atributo type del elemento <Content>.

    - URL: incluyen contenido de un sitio remoto, pero no tienen acceso completo a las características del contenedor.
           Este tipo de gadget es compatible con la compatibilidad con los gadgets de iGoogle heredados existentes,
           pero se considera obsoleto y debe evitarse al crear nuevos gadgets.

    - HTML: incluyen el contenido directamente dentro del elemento <Content>. Esto incluye el codigo HTML, CSS y JavaScript que el contenedor representará en el iframe del gadget.
     Este contenido debe incluirse en una sección CDATA para evitar que el analizador de especificaciones del gadget interprete el marcado HTML incrustado como XML.

    Los gadgets pueden definir múltiples secciones de contenido, cada una con una vista diferente.
    Las vistas admitidas por los contenedores de Atlassian son predeterminadas para la vista estándar de un gadget en una página junto con otros gadgets y contenido,
    y canvas para la vista maximizada de un solo gadget en una página por sí solo. Otros contenedores pueden admitir tipos de vista adicionales.
    Si la misma sección de contenido debe mostrarse en más de una vista, puede especificar varias vistas, separadas por comas.

    href="__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/html/jira-gadget-qrapids-plugin.html"
    -->

    <Content type="html" view="canvas,profile" >
        <![CDATA[

            #requireResource("com.atlassian.jira.gadgets:common")
            #requireResource("com.atlassian.gadgets.publisher:ajs-gadgets")
            #requireResource("com.atlassian.plugins.qrapids:jira-gadget-qrapids-plugin")
            #requireResource("confluence.web.resources:jquery")
            #requireResource("confluence.web.resources:ajs")
            #requireResource("com.atlassian.auiplugin:ajs")
            #supportedLocales("gadget.common")
            #includeResources()


            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
            <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

            <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.js"></script>
            <script src="https://d3js.org/d3.v5.js"></script>

            <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
            <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>


            <script src="__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/js/gaugeChart.js" type="text/javascript"></script>
            <script src="__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/js/radarChart.js" type="text/javascript"></script>
            <script src="__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/js/lineChart.js" type="text/javascript"></script>
            <script src="__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/js/stackedLineChart.js" type="text/javascript"></script>
            <script src="__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/js/scriptDatePicker.js" type="text/javascript"></script>
            <script src="__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/js/jira-gadget-qrapids-plugin.js" type="text/javascript"></script>
            <link href="__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/css/jira-gadget-qrapids-plugin.css" type="text/css" rel="stylesheet">

            <script type="text/javascript">
                (function() {
                    var dataCurrentSI = [];
                    var dataHistoricalSI  = [];

                    var dataCurrentDSI  = [];
                    var dataHistoricalDSI  = [];

                    var dataCurrentQF  = [];
                    var dataHistoricalQF  = [];

                    var dataCurrentM  = [];
                    var dataHistoricalM  = [];

                    var viewItemText = ["Graphical","Table","Radar","Historical"];
                    var currentProject;

                    var from = '2015-01-01';
                    var to = getToday();

                    function buildDivView(currentProject) {

                        console.log("####################### buildDivView #######################");

                        var divView = document.getElementsByClassName('view');

                        //TopNav
                        var div_TopNav = document.createElement('div');
                        div_TopNav.setAttribute("class", "topnav");
                        div_TopNav.setAttribute("id","id_TopNav");

                        //Dropdown menu
                        var spanPosition = document.createElement('span');
                        spanPosition.setAttribute("class", "span-position");

                        var divDropdown = document.createElement('div');
                        divDropdown.setAttribute("class", "dropdown");

                        var buttonDropdown = document.createElement('button');
                        buttonDropdown.setAttribute("type","button");
                        buttonDropdown.setAttribute("class","btn btn-default dropdown-toggle margin-button-nav");
                        buttonDropdown.setAttribute("data-toggle","dropdown");
                        buttonDropdown.setAttribute("aria-haspopup","true");
                        buttonDropdown.setAttribute("aria-expanded","false");

                        var imageDropdown = document.createElement('img');
                        imageDropdown.setAttribute("src","__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/images/view-mode.png");
                        buttonDropdown.appendChild(imageDropdown);

                        var ulDropdown = document.createElement('ul');
                        ulDropdown.setAttribute("class","dropdown-menu");

                        for (i = 0; i < viewItemText.length; ++i) {
                            var id = "id_" + viewItemText[i];
                            var liDropdown = document.createElement('li');
                            var aLi = document.createElement('a');
                            aLi.setAttribute("id",id);
                            if (i == 0 ||i == 2) aLi.setAttribute("class", "active");
                            var imgLi = document.createElement('img');
                            imgLi.setAttribute("class","icons-view-mode");
                            if (viewItemText[i] == "Graphical") {
                                imgLi.setAttribute("src","__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/images/graphical.png");
                                imgLi.setAttribute("alt","graphical data");
                            }
                            else if (viewItemText[i] == "Table") {
                                imgLi.setAttribute("src","__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/images/table.png");
                                imgLi.setAttribute("alt","table data");
                            }
                            else if (viewItemText[i] == "Radar") {
                                imgLi.setAttribute("src","__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/images/radar.png");
                                imgLi.setAttribute("alt","radar data");
                            }
                            else if (viewItemText[i] == "Historical") {
                                imgLi.setAttribute("src","__ATLASSIAN_BASE_URL__/download/resources/com.atlassian.plugins.qrapids.jira-gadget-qrapids-plugin/images/histo.png");
                                imgLi.setAttribute("alt","historical data");
                            }

                            aLi.appendChild(imgLi);
                            aLi.append(viewItemText[i]);
                            liDropdown.appendChild(aLi);
                            ulDropdown.appendChild(liDropdown);
                            if (i == 1) {
                                var liSeparator = document.createElement('li');
                                liSeparator.setAttribute("role","separator");
                                liSeparator.setAttribute("class","divider");
                                ulDropdown.appendChild(liSeparator);
                            }
                        }

                        divDropdown.appendChild(buttonDropdown);
                        divDropdown.appendChild(ulDropdown);
                        spanPosition.appendChild(divDropdown);
                        div_TopNav.appendChild(spanPosition);

                        //Tab SI
                        var tab = document.createElement('a');
                        tab.setAttribute("id","id_tab_si");
                        tab.setAttribute("class","tab-nav active");
                        tab.setAttribute("data-toggle","tab");
                        tab.setAttribute("href","#si");
                        tab.setAttribute("style","margin-left: 50px;");
                        var text = document.createTextNode("Strategic Indicators");
                        tab.appendChild(text);
                        div_TopNav.appendChild(tab);

                        //Tab DSI
                        tab = document.createElement('a');
                        tab.setAttribute("id","id_tab_dsi");
                        tab.setAttribute("class","tab-nav");
                        tab.setAttribute("data-toggle","tab");
                        tab.setAttribute("href","#dsi");
                        text = document.createTextNode("Detailed Strategic Indicators");
                        tab.appendChild(text);
                        div_TopNav.appendChild(tab);

                        //Tab QF
                        tab = document.createElement('a');
                        tab.setAttribute("id","id_tab_qf");
                        tab.setAttribute("class","tab-nav");
                        tab.setAttribute("data-toggle","tab");
                        tab.setAttribute("href","#qf");
                        text = document.createTextNode("Quality Factors");
                        tab.appendChild(text);
                        div_TopNav.appendChild(tab);

                        //Tab M
                        tab = document.createElement('a');
                        tab.setAttribute("id","id_tab_m");
                        tab.setAttribute("class","tab-nav");
                        tab.setAttribute("data-toggle","tab");
                        tab.setAttribute("href","#m");
                        text = document.createTextNode("Metrics");
                        tab.appendChild(text);
                        div_TopNav.appendChild(tab);

                        //Tab QR
                        tab = document.createElement('a');
                        tab.setAttribute("id","id_tab_qr");
                        tab.setAttribute("class","tab-nav");
                        tab.setAttribute("data-toggle","tab");
                        tab.setAttribute("href","#qr");
                        text = document.createTextNode("QR");
                        tab.appendChild(text);
                        div_TopNav.appendChild(tab);

                        //Tab Project
                        tab = document.createElement('span');
                        tab.setAttribute("id","id_tab_project");
                        tab.setAttribute("class","current-project-style navbar-text");
                        console.log(currentProject);
                        tab.append(currentProject);
                        div_TopNav.appendChild(tab);

                        //TabContent
                        var div_TabContent = document.createElement('div');
                        div_TabContent.setAttribute("class", "tab-content clearfix");
                        div_TabContent.setAttribute("id","id_TabContent");

                        //Div SI
                        var divTab = document.createElement('div');
                        divTab.setAttribute("class","tab-pane active");
                        divTab.setAttribute("id","si");
                        div_TabContent.appendChild(divTab);

                        //Div DSI
                        divTab = document.createElement('div');
                        divTab.setAttribute("class","tab-pane");
                        divTab.setAttribute("id","dsi");
                        div_TabContent.appendChild(divTab);

                        //Div QF
                        divTab = document.createElement('div');
                        divTab.setAttribute("class","tab-pane");
                        divTab.setAttribute("id","qf");
                        div_TabContent.appendChild(divTab);

                        //Div M
                        divTab = document.createElement('div');
                        divTab.setAttribute("class","tab-pane");
                        divTab.setAttribute("id","m");
                        div_TabContent.appendChild(divTab);

                        //Div QR
                        divTab = document.createElement('div');
                        divTab.setAttribute("class","tab-pane");
                        divTab.setAttribute("id","qr");
                        div_TabContent.appendChild(divTab);

                        divView.item(0).append(div_TopNav);
                        divView.item(0).append(div_TabContent);
                    }

                    var gadgetQRAPID = AJS.Gadget({
                        baseUrl: "__ATLASSIAN_BASE_URL__",
                        useOauth: "/rest/gadget/1.0/currentUser",
                        config: {
                           descriptor: function(args) {
                               var gadget = this;

                               var listProjects = [];

                               args.projectData.forEach(function(item) {
                                    var currentItem = {label: item, value: item};
                                    listProjects.push(currentItem);
                               });

                               return {
                                    action: "/rest/gadget/1.0/currentUser",
                                    theme : function () {
                                        if (gadgets.window.getViewportDimensions().width < 450) {
                                            return "gdt top-label";
                                        } else {
                                           return "gdt";
                                        }
                                    }(),
                                    fields: [
                                        {
                                            userpref: "selectProjectUserPref",
                                            label: "Project:",
                                            description: "Select project",
                                            type: "select",
                                            selected: gadget.getPref("selectProjectUserPref"),
                                            options: listProjects
                                        },

                                        AJS.gadget.fields.nowConfigured()

                                   ]
                               };
                           },
                           args: [
                                {
                                    key: "projectData",
                                    ajaxOptions: function() {
                                        return {
                                            url: "/rest/qrapids-gadget/1.0/Projects/AssessedProjects.json"
                                        };
                                    }
                                }
                           ]
                        },
                        view: {
                            enableReload: false,
                            onResizeReload: false,
                            onResizeAdjustHeight: true,
                            template: function(args) {

                                console.log(" \\\\\\\\\\\\\\ args ///////////// ");
                                console.log(args);

                                var gadget = this;

                                var projectSelected = gadget.getPref("selectProjectUserPref");
                                if ($('#id_tab_project').length == 0) {
                                    currentProject = projectSelected;
                                    buildDivView(currentProject);
                                }
                                else {
                                    if (currentProject != projectSelected) {
                                        currentProject = projectSelected;
                                        document.getElementById("id_tab_project").innerHTML = currentProject;
                                    }
                                }



                                var dataCurrentSI = args.dtoCSI;
                                var dataHistoricalSI  = args.dtoHSI;

                                var dataCurrentDSI  = args.dtoCDSI;
                                var dataHistoricalDSI  = args.dtoHDSI;

                                var dataCurrentQF  = args.dtoCQF;
                                var dataHistoricalQF  = args.dtoHQF;

                                var dataCurrentM;
                                var dataHistoricalM  = args.dtoHM;

                                printCurrentChartSI(dataCurrentSI);

                                // Tabs
                                $('#id_tab_si').on('click', function(){
                                    $(".tab-nav").removeClass('active');
                                    $('#id_tab_si').addClass('active');

                                    if ($('#id_Graphical').hasClass('active') && $('#id_Radar').hasClass('active')) printCurrentChartSI(dataCurrentSI);
                                    else if ($('#id_Graphical').hasClass('active') && $('#id_Historical').hasClass('active')) printHistoricalChartSI(dataHistoricalSI);
                                    else if ($('#id_Table').hasClass('active') && $('#id_Radar').hasClass('active')) printCurrentTableSI(dataCurrentSI);
                                    else if ($('#id_Table').hasClass('active') && $('#id_Historical').hasClass('active')) printHistoricalTableSI(dataHistoricalSI);
                                });

                                $('#id_tab_dsi').on('click', function(){
                                    $(".tab-nav").removeClass('active');
                                    $('#id_tab_dsi').addClass('active');

                                    if ($('#id_Graphical').hasClass('active') && $('#id_Radar').hasClass('active')) printCurrentChartDSI(dataCurrentDSI);
                                    else if ($('#id_Graphical').hasClass('active') && $('#id_Historical').hasClass('active')) printHistoricalChartDSI(dataHistoricalDSI);
                                    else if ($('#id_Table').hasClass('active') && $('#id_Radar').hasClass('active')) printCurrentTableDSI(dataCurrentDSI);
                                    else if ($('#id_Table').hasClass('active') && $('#id_Historical').hasClass('active')) printHistoricalTableDSI(dataHistoricalDSI);
                                });

                                $('#id_tab_qf').on('click', function(){
                                    $(".tab-nav").removeClass('active');
                                    $('#id_tab_qf').addClass('active');

                                    if ($('#id_Graphical').hasClass('active') && $('#id_Radar').hasClass('active')) printCurrentChartQF(dataCurrentQF);
                                    else if ($('#id_Graphical').hasClass('active') && $('#id_Historical').hasClass('active')) printHistoricalChartQF(dataHistoricalQF);
                                    else if ($('#id_Table').hasClass('active') && $('#id_Radar').hasClass('active')) printCurrentTableQF(dataCurrentQF);
                                    else if ($('#id_Table').hasClass('active') && $('#id_Historical').hasClass('active')) printHistoricalTableQF(dataHistoricalQF);
                                });

                                $('#id_tab_m').on('click', function(){
                                    $(".tab-nav").removeClass('active');
                                    $('#id_tab_m').addClass('active');

                                    if ($('#id_Graphical').hasClass('active') && $('#id_Radar').hasClass('active')) printCurrentChartM(dataCurrentM);
                                    else if ($('#id_Graphical').hasClass('active') && $('#id_Historical').hasClass('active')) printHistoricalChartM(dataHistoricalM);
                                    else if ($('#id_Table').hasClass('active') && $('#id_Radar').hasClass('active')) printCurrentTableM(dataCurrentM);
                                    else if ($('#id_Table').hasClass('active') && $('#id_Historical').hasClass('active')) printHistoricalTableM(dataHistoricalM);
                                });

                                // Menus Items Dropdown

                                // G
                                $('#id_Graphical').on('click', function(){
                                    $("#id_Table").removeClass('active');
                                    $('#id_Graphical').addClass('active');

                                    // -> R
                                    if ($('#id_Radar').hasClass('active')) {
                                        console.log(" ________________________ G -> R ________________________ ");
                                        if ($('#id_tab_si').hasClass('active')) printCurrentChartSI(dataCurrentSI);
                                        else if ($('#id_tab_dsi').hasClass('active')) printCurrentChartDSI(dataCurrentDSI);
                                        else if ($('#id_tab_qf').hasClass('active')) printCurrentChartQF(dataCurrentQF);
                                        else if ($('#id_tab_m').hasClass('active')) printCurrentChartM(dataCurrentM);
                                    }
                                    // -> H
                                    else {
                                        console.log(" ________________________ G -> H ________________________ ");
                                        if ($('#id_tab_si').hasClass('active')) printHistoricalChartSI(dataHistoricalSI);
                                        else if ($('#id_tab_dsi').hasClass('active')) printHistoricalChartDSI(dataHistoricalDSI);
                                        else if ($('#id_tab_qf').hasClass('active')) printHistoricalChartQF(dataHistoricalQF);
                                        else if ($('#id_tab_m').hasClass('active')) printHistoricalChartM(dataHistoricalM);
                                    }
                                });

                                // T
                                $('#id_Table').on('click', function(){
                                    $("#id_Graphical").removeClass('active');
                                    $('#id_Table').addClass('active');

                                    // -> R
                                    if ($('#id_Radar').hasClass('active')) {
                                        console.log(" ________________________ T -> R ________________________ ");
                                        if ($('#id_tab_si').hasClass('active')) printCurrentTableSI(dataCurrentSI);
                                        else if ($('#id_tab_dsi').hasClass('active')) printCurrentTableDSI(dataCurrentDSI);
                                        else if ($('#id_tab_qf').hasClass('active')) printCurrentTableQF(dataCurrentQF);
                                        else if ($('#id_tab_m').hasClass('active')) printCurrentTableM(dataCurrentM);
                                    }

                                    // -> H
                                    else {
                                        console.log(" ________________________ T -> H ________________________ ");
                                        if ($('#id_tab_si').hasClass('active')) printHistoricalTableSI(dataHistoricalSI);
                                        else if ($('#id_tab_dsi').hasClass('active')) printHistoricalTableDSI(dataHistoricalDSI);
                                        else if ($('#id_tab_qf').hasClass('active')) printHistoricalTableQF(dataHistoricalQF);
                                        else if ($('#id_tab_m').hasClass('active')) printHistoricalTableM(dataHistoricalM);
                                    }
                                });

                                // R
                                $('#id_Radar').on('click', function(){
                                    $("#id_Historical").removeClass('active');
                                    $('#id_Radar').addClass('active');

                                    // G
                                    if ($('#id_Graphical').hasClass('active')) {
                                        console.log(" ________________________ G <- R ________________________ ");
                                        if ($('#id_tab_si').hasClass('active')) printCurrentChartSI(dataCurrentSI);
                                        else if ($('#id_tab_dsi').hasClass('active')) printCurrentChartDSI(dataCurrentDSI);
                                        else if ($('#id_tab_qf').hasClass('active')) printCurrentChartQF(dataCurrentQF);
                                        else if ($('#id_tab_m').hasClass('active')) printCurrentChartM(dataCurrentM);
                                    }

                                    // T
                                    else {
                                        console.log(" ________________________ T <- R ________________________ ");
                                        if ($('#id_tab_si').hasClass('active')) printCurrentTableSI(dataCurrentSI);
                                        else if ($('#id_tab_dsi').hasClass('active')) printCurrentTableDSI(dataCurrentDSI);
                                        else if ($('#id_tab_qf').hasClass('active')) printCurrentTableQF(dataCurrentQF);
                                        else if ($('#id_tab_m').hasClass('active')) printCurrentTableM(dataCurrentM);
                                    }
                                });

                                // H
                                $('#id_Historical').on('click', function(){
                                    $("#id_Radar").removeClass('active');
                                    $('#id_Historical').addClass('active');

                                    // G
                                    if ($('#id_Graphical').hasClass('active')) {
                                        console.log(" ________________________ G <- H ________________________ ");
                                        if ($('#id_tab_si').hasClass('active')) printHistoricalChartSI(dataHistoricalSI);
                                        else if ($('#id_tab_dsi').hasClass('active')) printHistoricalChartDSI(dataHistoricalDSI);
                                        else if ($('#id_tab_qf').hasClass('active')) printHistoricalChartQF(dataHistoricalQF);
                                        else if ($('#id_tab_m').hasClass('active')) printHistoricalChartM(dataHistoricalM);
                                    }

                                    // T
                                    else {
                                        console.log(" ________________________ T <- H ________________________ ");
                                        if ($('#id_tab_si').hasClass('active')) printHistoricalTableSI(dataHistoricalSI);
                                        else if ($('#id_tab_dsi').hasClass('active')) printHistoricalTableDSI(dataHistoricalDSI);
                                        else if ($('#id_tab_qf').hasClass('active')) printHistoricalTableQF(dataHistoricalQF);
                                        else if ($('#id_tab_m').hasClass('active')) printHistoricalTableM(dataHistoricalM);
                                    }
                                });
                            },
                            args: [
                                {
                                    key: "dtoCSI",
                                    ajaxOptions: function() {
                                        return {
                                            url: "/rest/qrapids-gadget/1.0/StrategicIndicators/CurrentEvaluation.json"
                                        };
                                    }
                                },
                                {
                                    key: "dtoCDSI",
                                    ajaxOptions: function() {
                                        return {
                                            url: "/rest/qrapids-gadget/1.0/DetailedStrategicIndicators/CurrentEvaluation.json"
                                        };
                                    }
                                },
                                {
                                    key: "dtoCQF",
                                    ajaxOptions: function() {
                                        return {
                                            url: "/rest/qrapids-gadget/1.0/QualityFactors/CurrentEvaluation.json"
                                        };
                                    }
                                },
                                /*{
                                    key: "dtoCM",
                                    ajaxOptions: function() {
                                        return {
                                            url: "/rest/qrapids-gadget/1.0/Metrics/CurrentEvaluation.json"
                                        };
                                    }
                                },*/
                                {
                                    key: "dtoHM",
                                    ajaxOptions: function() {
                                        return {
                                            url: "/rest/qrapids-gadget/1.0/Metrics/HistoricalData/from="+ from +"&to="+ to +".json"
                                        };
                                    }
                                },
                                {
                                    key: "dtoHQF",
                                    ajaxOptions: function() {
                                        return {
                                            url: "/rest/qrapids-gadget/1.0/QualityFactors/HistoricalData/from="+ from +"&to="+ to +".json"
                                        };
                                    }
                                },
                                {
                                    key: "dtoHDSI",
                                    ajaxOptions: function() {
                                        return {
                                            url: "/rest/qrapids-gadget/1.0/DetailedStrategicIndicators/HistoricalData/from="+ from +"&to="+ to +".json"
                                        };
                                    }
                                },
                                {
                                    key: "dtoHSI",
                                    ajaxOptions: function() {
                                        return {
                                            url: "/rest/qrapids-gadget/1.0/StrategicIndicators/HistoricalData/from="+ from +"&to="+ to +".json"
                                        };
                                    }
                                }
                            ]
                        }
                    });
                })();

            </script>
        ]]>
    </Content>
</Module>